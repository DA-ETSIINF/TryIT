{% extends 'congress/base.html' %}

{% block content %}{% load staticfiles %}
	<div class="row">
		<div class="col s12 m8 offset-m2">
			<div class="card-panel">
				<h5 class="center-align">¡Consigue tu entrada gratis!</h5>

				<form name="ticketForm" ng-controller="ticketValidationController" ng-submit="newTicket(attendant)" novalidate>
					{% verbatim %}
					<div> ticketForm is {{ ticketForm.$valid}}</div>
					{% endverbatim %}
					<!-- name -->
					<div class="row">
						<div class="input-field col l6 s12">
							<input name="name" id="name" type="text" ng-model="attendant.name"
										 ng-class="{ valid: ticketForm.name.$valid, invalid:ticketForm.name.$invalid && ticketForm.name.$dirty }"
										 required>
							<label for="name">Nombre</label>
						</div>
					</div>

					<!-- lastname -->
					<div class="row">
						<div class="input-field col l6 s12">
							<input name="lastname" id="lastname" type="text" ng-model="attendant.lastname"
										 ng-class="{ valid: ticketForm.lastname.$valid, invalid:ticketForm.lastname.$invalid && ticketForm.lastname.$dirty }"
										 required>
							<label for="lastname">Apellidos</label>
						</div>
					</div>

					<!-- email -->
					<div class="row">
						<div class="input-field col l6 s12">
							<input name="email" id="email" type="email" ng-model="attendant.email"
										 ng-class="{ valid: ticketForm.email.$valid, invalid:ticketForm.email.$invalid && ticketForm.email.$dirty }"
										 required>
							<label for="email">Correo electrónico</label>
						</div>
					</div>

					<!-- student -->
					<div class="row">
						<div class="col s12">
							<label class="description">¿Eres estudiante?</label>
						</div>
						<div class="col s12">
							<input class="with-gap" name="student" type="radio" id="yes" ng-model="attendant.student"
										 ng-value="true"/>
							<label for="yes">Si</label>
							<input class="with-gap" name="student" type="radio" id="no" ng-model="attendant.student"
										 ng-value="false"/>
							<label for="no">No</label>
						</div>
					</div>

					<!-- upm student -->
					<div class="row" ng-show="attendant.student">
						<div class="col s12">
							<label class="description">¿Eres de la Universidad Politécnica de Madrid?</label>
						</div>
						<div class="col s12">
							<input class="with-gap" name="upm_student" type="radio" id="upm_yes" ng-model="attendant.upm_student"
										 ng-value="true"/>
							<label for="upm_yes">Si</label>
							<input class="with-gap" name="upm_student" type="radio" id="upm_no" ng-model="attendant.upm_student"
										 ng-value="false"/>
							<label for="upm_no">No</label>
						</div>
					</div>

					<div ng-show="attendant.student && attendant.upm_student">

						<!-- college -->
						<div class="row">
							<div class="col l6 s12">
								<label for="college">Elige tu Escuela o Facultad</label>
								<select id="college" class="browser-default">
									{% for college in colleges %}
										<option ng-model="attendant.college" value="{{ college.0 }}">{{ college.1 }}</option>
									{% endfor %}
								</select>
							</div>
						</div>

						<!-- degree -->
						<div class="row">
							<div class="input-field col l6 s12">
								<input name="degree" id="degree" type="text" ng-model="attendant.degree"
											 ng-class="{ valid: ticketForm.degree.$valid, invalid:ticketForm.degree.$invalid && ticketForm.degree.$dirty }"
											 ng-required="attendant.student && attendant.upm_student">
								<label for="degree">Titulación</label>
							</div>
						</div>

						<!-- grade -->
						<div class="row">
							<div class="input-field col l6 s12">
								<input name="grade" id="grade" type="number" min="1" max="4" ng-model="attendant.grade"
											 ng-class="{ valid: ticketForm.grade.$valid, invalid:ticketForm.grade.$invalid && ticketForm.grade.$dirty }"
											 ng-required="attendant.student && attendant.upm_student">
								<label for="grade">Curso</label>
							</div>
						</div>

						<!-- dni -->
						<div class="row">
							<div class="input-field col l6 s12">
								<input name="identity" id="identity" type="text" ng-model="attendant.identity"
											 ng-class="{ valid: ticketForm.identity.$valid, invalid:ticketForm.identity.$invalid && ticketForm.identity.$dirty }"
											 ng-required="attendant.student && attendant.upm_student"
											 ng-pattern="identityPattern">
								<label for="identity">DNI / NIE</label>
							</div>
						</div>

						<!-- phone -->
						<div class="row">
							<div class="input-field col l6 s12">
								<input name="phone" id="phone" type="tel" ng-model="attendant.phone"
											 ng-class="{ valid: ticketForm.phone.$valid, invalid:ticketForm.phone.$invalid && ticketForm.phone.$dirty }"
											 ng-required="attendant.student && attendant.upm_student">
								<label for="phone">Teléfono</label>
							</div>
						</div>

					</div>
					<a class="waves-effect waves-light btn light-green" href>Conseguir entrada</a>
				</form>
			</div>
		</div>
	</div>

	<script>
		$(document).ready(function () {
			$('select').material_select();
		});
	</script>
{% endblock %}